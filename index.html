<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <script src="https://cdn.jsdelivr.net/npm/p5@1.9.0/lib/p5.min.js"></script>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: transparent;
    }
    canvas {
      display: block;
    }
  </style>
</head>
<body>
<script>
let lines = [];
let spacing = 20;
let phase = 0;
let scrollY = 0;

window.addEventListener('message', (event) => {
  if (event.data && typeof event.data.scrollY === 'number') {
    scrollY = event.data.scrollY;
  }
});

function setup() {
  createCanvas(windowWidth, 400);
  noFill();
  stroke(255, 120);
  for (let y = 0; y < height; y += spacing) {
    lines.push(y);
  }
  textSize(16);
  textAlign(LEFT, TOP);
  fill(255);
  noStroke();
}

function draw() {
  clear();
  phase += 0.01;

  let section = getScrollSection(scrollY);

  stroke(255, 120);
  for (let i = 0; i < lines.length; i++) {
    beginShape();
    for (let x = 0; x < width; x += 10) {
      let y;
      if (section === 1) {
        y = lines[i] + sin(x * 0.015 + phase + i) * 10;
      } else if (section === 2) {
        y = lines[i];
      } else {
        y = lines[i] + sin(x * 0.02 + phase + i) * 4 + cos(x * 0.01 + i) * 2;
      }
      vertex(x, y);
    }
    endShape();
  }

  // Debug overlay
  noStroke();
  fill(255);
  rect(0, 0, 300, 60);
  fill(0);
  text("scrollY: " + scrollY.toFixed(0), 10, 10);
  text("section: " + section, 10, 30);
}

function getScrollSection(scrollY) {
  if (scrollY < 300) return 1;
  else if (scrollY < 1000) return 2;
  else return 3;
}

function windowResized() {
  resizeCanvas(windowWidth, 400);
}
</script>
</body>
</html>